# R4a Checkpoint

Timestamp (UTC): 2026-01-25T00:00:00Z

Windows:
- Backtest scope: 2025-07-01 → 2026-01-09 (horizon=10 trading days)
- Validation artifacts written under App/data/analysis

Decisions:
- Blessed R4a master (R4a_candidate):
  - Quality: F10/C1 < 1.03 (fixed gate across all configs)
  - Direction: F10/MA20 ≥ 1.03
  - Momentum: BB %b ≥ 0.60
  - Persistence: 2 of last 3 days (2-of-3)
  - Tape: OFF (market flag still computed, not gating)
- Hit definition: A(T+10) − F10 ≥ 0 (cash delta vs forecast ≥ 0)
- Costs: none
- Universe: full certified universe, all names/sectors

Grid search (2025-07-01 → 2026-01-09):
- File: App/data/analysis/r4a_grid_20260109.csv (+ .md)
- Top risk-adjusted contender: θ=1.02, %b≥0.50, persist=3-of-5, tape OFF
- R4a_candidate remains comparable; bootstrap CIs show no statistically significant difference on this 6‑month window.

Monthly performance (cash delta vs F10):
- R4a_candidate (θ=1.03, %b≥0.60, 2-of-3): App/data/analysis/r4a_monthly_20250701_20260109_theta1p03_bb0p60_persist2of3.csv
  - TOTAL: trades=1155, %win=0.452, avg_win=4.2295, avg_loss=−5.9930, maxDD=1955.2794
- Contender (θ=1.02, %b≥0.50, 3-of-5): App/data/analysis/r4a_monthly_20250701_20260109_theta1p02_bb0p50_persist3of5.csv
  - TOTAL: trades=1374, %win=0.448, avg_win=4.0890, avg_loss=−5.6690, maxDD=1950.8228
- Variant check: R4a with 3-of-5 persistence is weaker on this window (TOTAL trades=1072, %win=0.441).

Bootstrap CIs (2000 resamples): App/data/analysis/r4a_bootstrap_ci_20250701_20260109.csv
- TOTAL win rate 95% CI: R4a [0.423, 0.481], Contender [0.421, 0.475], diff CI [−0.044, +0.036]
- TOTAL mean cash 95% CI: R4a [−2.123, −0.675], Contender [−1.911, −0.713], diff CI [−0.865, +1.052]
- By month: all win/mean diffs include 0 → no significant separation in this window.

Production/export changes:
- scripts/export_dashboard_for_date.py
  - Added R4a summary fields: spy_trend_bin (T−1 10d), rule_4a (2-of-3), stop_loss_pct
  - Stop-loss policies (CLI):
    - boll_lower (default): LB = MA20 − k·SD20 at T−1 (k default 2.0)
    - vol_q: lower quantile of last N daily returns (default q=0.10, N=20)
  - Robust prev-business-day resolution; momentum fallbacks from prices; QC prints
- Daily_LSTM/index.html (prod)
  - Removed “R4a Preview” link; appended columns: Market, R4a, Stop (far right)
  - UI QC counters for Market/R4a/Stops and stable joining on symbol
- Morning/nightly cron reviewed
  - Monday previous-business-day logic verified (Fri handling OK)

Backfill for visual QA:
- Generated certified files: Daily_LSTM/App/data/certified_candidates_20260119..20260123.csv
- Also generated 2026-01-09 for spot checks

Next steps:
- Optional walk-forward beyond 6 months; extend grid (%b 0.55/0.70/0.80; tape SPY>SMA100/5d>0; RSI cap) and stability plots
- Consider exhaustion guard (e.g., exclude %b>0.98) and/or distance-to-upper-BB cap
- If promoting to R4a_prod_v1, lock thresholds and write release note
